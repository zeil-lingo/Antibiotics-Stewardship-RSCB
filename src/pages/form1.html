<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulir Permintaan Antimikroba RSCB</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  </head>
  
  <body>
    <section class="hero">
      <div class="hero-header">
        <div class="section has-text-centered">
            <nav class="navbar" role="navigation" aria-label="main navigation">
                <div class="navbar-brand">
                  <a class="navbar-item" href="../../index.html">
                    <button class="button is-primary">Kembali</button>
                  </a>
                </div>
              </nav>
            <img src="../assets/logo_ppra.png" style="max-width: 180px; height: auto;" alt="Logo Tim PPRA">
            <br>
            <br>
            <p class="title is-4">Formulir Permintaan Antimikroba Golongan <i>Reserve</i>
            <p class="subtitle">Rumah Sakit St. Carolus Borromeus - RSCB Kupang</h1></p>
        </div>
      </div>
    </section>

    <section class="section">
        <div class="columns is-centered is-half">
        <div class="box">
            <form id="form" class="container m-2 pl-2" method="POST">
                
                <div class="field">
                    <label class="label">Nama DPJP:</label>
                    <div class="control">
                        <input class="input" type="text" name="nama_dpjp" id="id_nama_dpjp" list="nama_dpjp_options" required>
                        <datalist id="nama_dpjp_options">
                            <option value="dr_danny_darmawan" label="dr. Danny Darmawan, Sp. PD">dr. Danny Darmawan, Sp. PD</option>
                            <option value="dr_heri_sutrisno" label="dr. Heri Sutrisno, Sp.PD - KHO">dr. Heri Sutrisno, Sp.PD - KHO</option>
                            <option value="dr_jefri" label="dr. Jefri, Sp. PD">dr. Jefri, Sp. PD</option>
                            <option value="dr_stefany_adi" label="dr. Stefany Adi W., Sp.PD - KGH">dr. Stefany Adi W., Sp.PD - KGH</option>
                            <option value="dr_imam_hafidh" label="dr. Imam Hafidh, Sp.B">dr.Imam Hafidh, Sp.B</option>
                            <option value="dr_marlon" label="dr. Marlon, Sp.An TI">dr. Marlon, Sp.An TI</option>
                            <option value="dr_telly_victorya" label="dr. Telly Victorya Kapitana, Sp.An TI">dr. Telly Victorya Kapitana, Sp.An TI</option>
                            <option value="dr_samlek_sunbanu" label="dr. Samlek E. Sunbanu, Sp.A">dr. Samlek E. Sunbanu, Sp.A</option>
                            <option value="dr_simplicia_m" label="Dr. dr. Simplicia M. A., Sp.A (K)">Dr. dr. Simplicia M. A., Sp.A (K)</option>
                            <option value="dr_tjahyo_s" label="dr. Tjahyo S., SpA">dr. Tjahyo S., SpA</option>
                            <option value="dr_setijo_halim" label="dr. Setijo Halim, Sp.B">dr. Setijo Halim, Sp.B</option>
                            <option value="dr_frida_silitonga" label="dr. Frida M. Silitonga, Sp.S">dr. Frida M. Silitonga, Sp.S</option>
                            <option value="dr_olivia_wijaya" label="dr. Olivia J. Wijaya, Sp.N">dr. Olivia J. Wijaya, Sp.N</option>
                            <option value="dr_niva_wilujeng" label="dr. Niva Wilujeng, Sp. JP">dr. Niva Wilujeng, Sp. JP</option>
                            <option value="dr_kristian_ratu" label="dr. Kristian Ratu, Sp.OG">dr. Kristian Ratu, Sp.OG</option>
                            <option value="dr_trisna_turwewi" label="dr. N. Trisna T. K. Turwewi, Sp. THT- KL">dr. N. Trisna T. K. Turwewi, Sp. THT- KL</option>
                            <option value="dr_made_tambunan" label="dr. Made P. Tambunan, Sp.U">dr. Made P. Tambunan, Sp.U</option>
                            <option value="dr_arian_d" label="dr. R. Arian D., Sp.BP-RE">dr. R. Arian D., Sp.BP-RE</option>
                            <option value="dr_andre_sinambela" label="dr. Andre Tongam Palopor Sinambela, Sp. EM">dr. Andre Tongam Palopor Sinambela, Sp. EM</option>
                            <option value="drg_ellen_p" label="drg. Ellen S. P., SpBM">drg. Ellen S. P., SpBM</option>
                            <option value="drg_revina_marpaung" label="drg. Revina Marpaung, SpKG">drg. Revina Marpaung, SpKG</option>
                        </datalist>
                    </div>
                </div>

            <div class="field">
                <label class="label">Nama Pasien:</label>
                <div class="control">
                    <input 
                    type="text" 
                    class="input" 
                    name="nama_pasien" 
                    id="id_nama_pasien"
                    required
                    />
                </div>
            </div>

            <div class="field">
                <label class="label">Ruangan:</label>
                <div class="control">
                    <div class="select">
                        <select name="ruangan" class="input" id="id_ruangan" required>
                            <option value="IGD">IGD</option>
                            <option value="ICU">ICU</option>
                            <option value="Poli">Poli</option>
                            <option value="Carolus Tim 1">Carolus Tim 1</option>
                            <option value="Carolus Tim 2">Carolus Tim 2</option>
                            <option value="Lukas">Lukas</option>
                            <option value="Lukas - Isolasi">Lukas - Isolasi</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="field">
                <label class="label">No. Rekam Medis:</label>
                <div class="control">
                    <input 
                    type="text" 
                    class="input" 
                    name="no_rekam_medis"
                    id="id_no_rekam_medis"
                    required>
                </div>
            </div>

            <div class="field">
                <label class="label">Tanggal Lahir:</label>
                <div class="control">
                    <input type="date" class="input" name="tanggal_lahir" id="id_tanggal_lahir">
                </div>
            </div>

            <div class="field">
                <label class="label">Jenis Kelamin:</label>
                <div class="control">
                    <label class="radio">
                        <input type="radio" name="jenis_kelamin" value="L" id='id_jenis_kelamin' required> L
                    </label>
                    <label class="radio">
                        <input type="radio" name="jenis_kelamin" value="P" id='id_jenis_kelamin' required> P
                    </label>
                </div>
            </div>

            <div class="field">
                <label class="label">Berat Badan:</label>
                <div class="control">
                    <input 
                    type="number" 
                    class="input" 
                    id="id_berat_badan"
                    name="berat_badan" 
                    step="0.1"
                    placeholder="Dalam Kg"
                    required>
                </div>
            </div>

            <div class="field">
                <label class="label">Tanggal MRS:</label>
                <div class="control">
                    <input type="date" class="input" name="tanggal_mrs" id="id_tanggal_mrs" required>
                </div>
            </div>

            <div class="field">
                <label class="label">Diagnosis:</label>
                <div class="control">
                    <input 
                    type="text"
                    class="input" 
                    name="diagnosis" 
                    id="id_diagnosis"
                    placeholder="Terutama diagnosis infeksi" 
                    required></input>
                </div>
            </div>

            <div class="field">
                <label class="label">Kode ICD-10:</label>
                <div class="control">
                    <input 
                    type="text"
                    class="input" 
                    name="kode_ICD" 
                    id="id_kode_ICD" 
                    placeholder="Tuliskan kode ICD-10 diagnosis utama" 
                    required></input>
                </div>
            </div>

            <div class="field">
                <label class="label">Penyakit Penyerta:</label>
                <div class="control">
                    <textarea class="textarea" name="penyakit_penyerta" id="id_penyakit_penyerta" placeholder="Tuliskan penyakit penyerta pasien, misalkan: Diabetes Melitus, Jantung" ></textarea>
                </div>
            </div>

            <div class="field">
                <label class="label">Anamnesis Singkat:</label>
                <div class="control">
                    <textarea class="textarea" name="kondisi_saat_ini" id="id_kondisi_saat_ini"></textarea>
                </div>
            </div>

            <div class="field">
                <label class="label">Keadaan Umum:</label>
                <div class="control">
                    <div class="select">
                        <select name="keadaan_umum" class="input" id="id_keadaan_umum" required>
                            <option value="sakit_ringan">Tampak Sakit Ringan</option>
                            <option value="sakit_sedang">Tampak Sakit Sedang</option>
                            <option value="sakit_berat">Tampak Sakit Berat</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="field">
            <label class="label">Tanda Vital:</label>
            <table class="table is-bordered is-fullwidth">
                <thead>
                    <tr>
                        <th>Tanda Vital</th>
                        <th>Saat Masuk</th>
                        <th>Sekarang</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>GCS</td>
                        <td><input type="text" class="input" name="GCS_masuk" id="id_GCS_masuk" required></td>
                        <td><input type="text" class="input" name="GCS_sekarang" id="id_GCS_sekarang" required></td>
                    </tr>

                    <tr>
                        <td>Tekanan Darah</td>
                        <td><input type="text" class="input" name="tekanan_darah_masuk" id="id_tekanan_darah_masuk" required></td>
                        <td><input type="text" class="input" name="tekanan_darah_sekarang" id="id_tekanan_darah_sekarang" required></td>
                    </tr>

                    <tr>
                        <td>Nadi</td>
                        <td><input type="text" class="input" name="nadi_masuk" id="id_nadi_masuk" required></td>
                        <td><input type="text" class="input" name="nadi_sekarang" id="id_nadi_sekarang" required></td>
                    </tr>

                    <tr>
                        <td>RR</td>
                        <td><input type="text" class="input" name="rr_masuk" id="id_rr_masuk" required></td>
                        <td><input type="text" class="input" name="rr_sekarang" id="id_rr_sekarang" required></td>
                    </tr>
                
                    <tr>
                        <td>Suhu</td>
                        <td><input type="text" class="input" name="suhu_masuk" id="id_suhu_masuk" required></td>
                        <td><input type="text" class="input" name="suhu_sekarang" id="id_suhu_sekarang" required></td>
                    </tr>
                </tbody>
            </table>
            </div>

            <div class="field">
                <label class="label">Pemeriksaan Fisik:</label>
                <div class="control">
                    <textarea class="textarea" name="pemeriksaan_fisik" id="id_pemeriksaan_fisik"></textarea>
                </div>
            </div>

            <br>
            <hr>
            <br>

            <h2 class="subtitle">Riwayat Antimikroba Sebelumnya</h2>
            <div class="field">
                <label class="label">Pasien Rujukan:</label>
                <div class="control">
                    <label class="radio">
                        <input type="radio" name="pasien_rujukan" id="id_pasien_rujukan" value="Ya" required> Ya
                    </label>
                    <label class="radio">
                        <input type="radio" name="pasien_rujukan" id="id_pasien_rujukan" value="Tidak" required> Tidak
                    </label>
                </div>
            </div>

            <div class="field">
                <label class="label">Nama RS Rujukan:</label>
                <div class="control">
                    <input type="text" class="input" name="nama_rs_rujukan" id="id_nama_rs_rujukan">
                </div>
            </div>
            <br>

            <div class="field">
                <label class="label">Riwayat Antimikroba sebelumnya / saat ini:</label>
                <div class="control">
                    <label class="radio">
                        <input type="radio" name="riwayat_antimikroba" id="id_riwayat_antimikroba" value="Ya"> Ya
                    </label>
                    <label class="radio">
                        <input type="radio" name="riwayat_antimikroba" id="id_riwayat_antimikroba" value="Tidak"> Tidak
                    </label>
                </div>
            </div>

            <table class="table is-bordered is-fullwidth">
                <thead>
                    <tr>
                        <th>Antimikroba Sebelumnya</th>
                        <th>Tanggal Pertama Pemberian</th>
                        <th>Dosis Per Pemberian:</th>
                        <th>Pemberian Per Hari</th>
                        <th>Durasi Pemberian</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="text" class="input" name="riw_antimikroba_1_nama" id="id_riw_antimikroba_1_nama"></td>
                        <td><input type="date" class="input" name="riw_antimikroba_1_tanggal" id="id_riw_antimikroba_1_tanggal"></td>
                        <td><input type="number" class="input" name="riw_antimikroba_1_dosis" id="id_riw_antimikroba_1_dosis" placeholder="dalam mg"></td>
                        <td><div class="select">
                            <select name="riw_antimikroba_1_per_hari" class="input" id="riw_antimikroba_1_per_hari" required>
                                <option value="OD">Once Daily (1x1)</option>
                                <option value="BD">Twice Daily (2x1)</option>
                                <option value="TID">Thrice Daily (3x1)</option>
                                <option value="QID">Four Times Daily (4x1)</option>
                            </select> </td>
                        <td><input type="number" class="input" name="riw_antimikroba_1_durasi" id="id_riw_antimikroba_1_durasi" placeholder="dalam hari"></td>
                    </tr>

                    <tr>
                        <td><input type="text" class="input" name="riw_antimikroba_2_nama" id="id_riw_antimikroba_2_nama"></td>
                        <td><input type="date" class="input" name="riw_antimikroba_2_tanggal" id="id_riw_antimikroba_2_tanggal"></td>
                        <td><input type="number" class="input" name="riw_antimikroba_2_dosis" id="id_riw_antimikroba_2_dosis" placeholder="dalam mg"></td>
                        <td><div class="select">
                            <select name="riw_antimikroba_2_per_hari" class="input" id="riw_antimikroba_2_per_hari" required>
                                <option value="OD">Once Daily (1x1)</option>
                                <option value="BD">Twice Daily (2x1)</option>
                                <option value="TID">Thrice Daily (3x1)</option>
                                <option value="QID">Four Times Daily (4x1)</option>
                            </select>   
                        </td>
                        <td><input type="number" class="input" name="riw_antimikroba_2_durasi" id="id_riw_antimikroba_2_durasi" placeholder="dalam hari"></td>
                    </tr>

                    <tr>
                        <td><input type="text" class="input" name="riw_antimikroba_3_nama" id="id_riw_antimikroba_3_nama"></td>
                        <td><input type="date" class="input" name="riw_antimikroba_3_tanggal" id="id_riw_antimikroba_3_tanggal"></td>
                        <td><input type="number" class="input" name="riw_antimikroba_3_dosis" id="id_riw_antimikroba_3_dosis" placeholder="dalam mg"></td>
                        <td><div class="select">
                            <select name="riw_antimikroba_3_per_hari" class="input" id="riw_antimikroba_3_per_hari" required>
                                <option value="OD">Once Daily (1x1)</option>
                                <option value="BD">Twice Daily (2x1)</option>
                                <option value="TID">Thrice Daily (3x1)</option>
                                <option value="QID">Four Times Daily (4x1)</option>
                            </select>   
                        </td>
                        <td><input type="number" class="input" name="riw_antimikroba_3_durasi" id="id_riw_antimikroba_3_durasi" placeholder="dalam hari"></td>
                    </tr>
                </tbody>
            </table>

            <div class="field">
            <label class="label">Permintaan Antimikroba</label>
            <table class="table is-bordered is-fullwidth">
                <tbody>
                    <tr>
                        <td>Nama Antimikroba</td>
                        <td>
                            <div class="select">
                                <select name="permintaan_antimikroba_1_nama" class="input" id="id_permintaan_antimikroba_1_nama" required>
                                    <option value="Meropenem">Meropenem</option>
                                    <option value="Ceftazidime">Ceftazidime</option>
                                </select>                        
                        </td>
                    </tr>
                    <tr>
                        <td>Dosis Per Pemberian:</td>
                        <td><input type="number" class="input" name="permintaan_antimikroba_dosis_1" id="id_permintaan_antimikroba_dosis_1" placeholder="dalam mg" required></td>
                    </tr>
                    <tr>
                        <td>Pemberian Per Hari:</td>
                        <td>
                            <div class="select">
                                <select name="permintaan_antimikroba_hari_1" class="input" id="id_permintaan_antimikroba_hari_1" required>
                                    <option value="OD">Once Daily (1x1)</option>
                                    <option value="BD">Twice Daily (2x1)</option>
                                    <option value="TID">Thrice Daily (3x1)</option>
                                    <option value="QID">Four Times Daily (4x1)</option>
                                </select>   
                            </div>
                    </tr>
                    <tr>
                        <td>Perkiraan Durasi Pemberian:</td>
                        <td><input type="text" class="input" name="permintaan_antimikroba_1_durasi" id="id_permintaan_antimikroba_1_durasi" placeholder="dalam hari"></td>
                    </tr>
                    <tr>
                        <td>Indikasi</td>
                        <td>
                            <label class="indikasi_1">
                                <input type="radio" name="permintaan_antimikroba_1_indikasi" value="Profilaksis" id="id_permintaan_antimikroba_1_indikasi" required> Profilaksis
                            </label>
                            <br>
                            <label class="indikasi_1">
                                <input type="radio" name="permintaan_antimikroba_1_indikasi" value="Terapi" id="id_permintaan_antimikroba_1_indikasi" required> Terapi
                            </label>
                        </td>    
                    </tr>
                    <!-- Repeat similar rows for other antimicrobials -->
                </tbody>
            </table>
            </div>

            <!-- Continue replacing remaining fields with Bulma classes as needed -->

            <br>
            <hr>
            <br>


                <h2 class="subtitle">Hasil Penunjang:</h2>
            <div class="field">
                <label class="label">Hasil Kultur:</label>
                <div class="control">
                    <label class="radio">
                        <input class="radio" type="radio" name="kultur_ada" id="id_kultur_ada" value="Ada">
                        Ada, lampirkan copy hasil kultur
                    </label>
                    <br>
                    <label class="radio">
                        <input class="radio" type="radio" name="kultur_ada" id="id_kultur_ada" value="Menunggu">
                        Menunggu hasil
                    </label>
                    <br>
                    <label class="radio">
                        <input class="radio" type="radio" name="kultur_ada" id="id_kultur_ada" value="Tidak Ada">
                        Tidak Ada
                    </label>
                </div>
            </div>

            <div class="field">
                <label class="label">Tanggal Pengambilan Kultur:</label>
                <div class="control">
                    <input type="date" class="input" name="kultur_tanggal" name="id_kultur_tanggal" id="id_kultur_tanggal">
                </div>
            </div>

            <label class="label">Hasil Pengambilan Kultur</label>
            <table class="table is-bordered is-fullwidth">
                <thead>
                    <tr>
                        <th>Tanggal Kultur</th>
                        <th>Spesimen</th>
                        <th>Hasil</th>
                        <th>Resisten / Intermediate / Sensitif</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="date" class="input" name="kultur_hasil_tanggal" id="id_kultur_hasil_tanggal"></td>
                        <td><input type="text" class="input" name="kultur_hasil_spesimen" id="id_kultur_hasil_spesimen"></td>
                        <td><input type="text" class="input" name="kultur_hasil_akhir" id="id_kultur_hasil_akhir"></td>
                        <td><input type="text" class="input" name="kultur_hasil_resistensi" id="id_kultur_hasil_resistensi"></td>
                    </tr>
                    <!-- Repeat similar rows for other samples -->
                </tbody>
            </table>

            <label class="label">Hasil Laboratorium</label>
            <table class="table is-bordered is-fullwidth">
                <thead>
                    <tr>
                        <th>Pemeriksaan</th>
                        <th>Ada?</th>
                        <th>Tanggal</th>
                        <th>Hasil</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Darah Lengkap</td>
                        <td>
                            <label class="radio"><input type="radio" name="darah_lengkap_ada" value="Ada" id='id_darah_lengkap_ada' required> Ada</label>
                            <br>
                            <label class="radio"><input type="radio" name="darah_lengkap_ada" value="Tidak" id='id_darah_lengkap_ada' required> Tidak</label>
                        </td>
                        <td><input type="date" class="input" name="darah_lengkap_tanggal" id="id_darah_lengkap_tanggal"></td>
                        
                        <td><textarea class="textarea" name="darah_lengkap_hasil" id="id_darah_lengkap_hasil"></textarea></td>
                    </tr>
                    <tr>
                        <td>Urine Lengkap</td>
                        <td>
                            <label class="radio"><input type="radio" name="urine_lengkap_ada" value="Ada" id='id_urine_lengkap_ada' required> Ada</label>
                            <br>
                            <label class="radio"><input type="radio" name="urine_lengkap_ada" value="Tidak" id='id_urine_lengkap_ada' required> Tidak</label>
                        </td>
                        <td><input type="date" class="input" name="urine_lengkap_tanggal" id="id_urine_lengkap_tanggal"></td>
                        <td><textarea class="textarea" name="urine_lengkap_hasil" id="id_urine_lengkap_hasil"></textarea></td>
                    </tr>
                    <tr>
                        <td>CRP</td>
                        <td>
                            <label class="radio"><input type="radio" name="crp_ada" value="Ada" id='id_crp_ada' required> Ada</label>
                            <br>
                            <label class="radio"><input type="radio" name="crp_ada" value="Tidak" id='id_crp_ada' required> Tidak</label>
                        </td>
                        <td><input type="date" class="input" name="crp_tanggal" id="id_crp_tanggal"></td>
                        <td><textarea class="textarea" name="crp_hasil" id="id_crp_hasil"></textarea></td>
                    </tr>
                    <tr>
                        <td>Prokalsitonin</td>
                        <td>
                            <label class="radio"><input type="radio" name="prokalsitonin_ada" value="Ada" id='id_prokalsitonin_ada' required> Ada</label>
                            <br>
                            <label class="radio"><input type="radio" name="prokalsitonin_ada" value="Tidak" id='id_prokalsitonin_ada' required> Tidak</label>
                        </td>
                        <td><input type="date" class="input" name="prokalsitonin_tanggal" id="id_prokalsitonin_tanggal"></td>
                        <td><textarea class="textarea" name="prokalsitonin_hasil" id="id_prokalsitonin_hasil"></textarea></td>
                    </tr>
                    <!-- Repeat similar rows for other examinations -->
                </tbody>
            </table>

            <label class="label">Hasil Pemeriksaan Radiologi / Penunjang lain</label>
            <table class="table is-bordered is-fullwidth">
                <thead>
                    <tr>
                        <th>Pemeriksaan</th>
                        <th>Tanggal</th>
                        <th>Hasil</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="text" class="input" name="radiologi_1_pemeriksaan" id="id_radiologi_1_pemeriksaan"></td>
                        <td><input type="date" class="input" name="radiologi_1_tanggal" id="id_radiologi_1_tanggal"></td>
                        <td><textarea class="textarea" name="radiologi_1_hasil" id="id_radiologi_1_hasil"></textarea>
                    </tr>
                    <tr>
                        <td><input type="text" class="input" name="radiologi_2_pemeriksaan" id="id_radiologi_2_pemeriksaan"></td>
                        <td><input type="date" class="input" name="radiologi_2_tanggal" id="id_radiologi_2_tanggal"></td>
                        <td><textarea class="textarea" name="radiologi_2_hasil" id="id_radiologi_2_hasil"></textarea>
                    </tr>
                    <!-- Repeat similar rows for other radiological examinations -->
                </tbody>
            </table>

                <div class="field is-grouped">
                    <div class="control">
                    <button class="button is-primary" type="submit" id="submit-button">
                        Submit
                    </button>
                    </div>
                </div>
                </form>
                <div
                id="message"
                style="
                    display: none;
                    margin: 20px;
                    font-weight: bold;
                    color: green;
                    padding: 8px;
                    background-color: beige;
                    border-radius: 4px;
                    border-color: aquamarine;
                "
                ></div>
            </form>
        </div>
      </section>

    
    <script>
    document.getElementById('id_nama_dpjp').addEventListener('input', function(event) {
        var input = event.target;
        var datalist = document.getElementById(input.getAttribute('list'));
        var options = datalist ? Array.from(datalist.options) : [];

        var selectedOption = options.find(function(option) {
            return option.value === input.value;
        });

        if (selectedOption) {
            input.value = selectedOption.textContent;
        }
    });
      
      document.getElementById("form").addEventListener("submit", function (e) {
        e.preventDefault(); // Prevent the default form submission
        document.getElementById("message").textContent = "Submitting..";
        document.getElementById("message").style.display = "block";
        document.getElementById("submit-button").disabled = true;

        // Collect the form data
        var formData = new FormData(this);
        var keyValuePairs = [];
        for (var pair of formData.entries()) {
          keyValuePairs.push(pair[0] + "=" + pair[1]);
        }

        var formDataString = keyValuePairs.join("&");

        // Send a POST request to your Google Apps Script
        fetch(
          "https://script.google.com/macros/s/AKfycbwLzMeytVZEpkf2XPIJTbtu5W1xxR7wXzYeH_aiPfQVZmZ-YvYztAttZGxPww8l3hIk/exec",
          { mode: 'no-cors',
            redirect: "follow",
            method: "POST",
            body: formDataString,
            headers: {
              "Content-Type": "text/plain;charset=utf-8",
            },
          }
        )
          .then(function (response) {
            // Check if the request was successful
            if (response) {
              return response; // Assuming your script returns JSON response
            } else {
              throw new Error("Failed to submit the form.");
            }
          })
          .then(function (data) {
            // Display a success message
            document.getElementById("message").textContent =
              "Data submitted successfully!";
            document.getElementById("message").style.display = "block";
            document.getElementById("message").style.backgroundColor = "green";
            document.getElementById("message").style.color = "beige";
            document.getElementById("submit-button").disabled = false;
            document.getElementById("form").reset();

            setTimeout(function () {
              document.getElementById("message").textContent = "";
              document.getElementById("message").style.display = "none";
            }, 2600);
          })

          .catch(function (error) {
            // Handle errors, you can display an error message here
            console.error(error);
            document.getElementById("message").textContent =
              "Sudah tersubmit! Mohon di-periksa kembali statusnya";
            document.getElementById("message").style.display = "block";
          });

          generatePDF()

    function generatePDF() {
      const { jsPDF } = window.jspdf;

      // Initialize jsPDF
      const doc = new jsPDF();

      // Collect form data specifically for namaDPJP
        const sel = document.getElementById('id_nama_dpjp');
        const id_nama_dpjp = sel.value;

      // Collect form data
      const id_nama_pasien = document.getElementById("id_nama_pasien").value;
      const id_ruangan = document.getElementById("id_ruangan").value;
        const id_no_rekam_medis = document.getElementById("id_no_rekam_medis").value;
        const id_tanggal_lahir = document.getElementById("id_tanggal_lahir").value;
        const id_jenis_kelamin = document.querySelector('input[name="jenis_kelamin"]:checked').value;
        const id_berat_badan = document.getElementById("id_berat_badan").value;
        const id_tanggal_mrs = document.getElementById("id_tanggal_mrs").value;
        const id_diagnosis = document.getElementById("id_diagnosis").value;
        const id_kode_ICD = document.getElementById("id_kode_ICD").value;
        const id_penyakit_penyerta = document.getElementById("id_penyakit_penyerta").value;
        const id_kondisi_saat_ini = document.getElementById("id_kondisi_saat_ini").value;
        const id_keadaan_umum = document.getElementById("id_keadaan_umum").value;
        const id_GCS_masuk = document.getElementById("id_GCS_masuk").value;
        const id_GCS_sekarang = document.getElementById("id_GCS_sekarang").value;
        const id_tekanan_darah_masuk = document.getElementById("id_tekanan_darah_masuk").value;
        const id_tekanan_darah_sekarang = document.getElementById("id_tekanan_darah_sekarang").value;
        const id_nadi_masuk = document.getElementById("id_nadi_masuk").value;
        const id_nadi_sekarang = document.getElementById("id_nadi_sekarang").value;
        const id_rr_masuk = document.getElementById("id_rr_masuk").value;
        const id_rr_sekarang = document.getElementById("id_rr_sekarang").value;
        const id_suhu_masuk = document.getElementById("id_suhu_masuk").value;
        const id_suhu_sekarang = document.getElementById("id_suhu_sekarang").value;
        const id_pemeriksaan_fisik = document.getElementById("id_pemeriksaan_fisik").value;
        const id_pasien_rujukan = document.querySelector('input[name="pasien_rujukan"]:checked').value;
        const id_nama_rs_rujukan = document.getElementById("id_nama_rs_rujukan").value;
        const id_riwayat_antimikroba = document.querySelector('input[name="riwayat_antimikroba"]:checked').value;
        const id_riw_antimikroba_1_nama = document.getElementById("id_riw_antimikroba_1_nama").value;
        const id_riw_antimikroba_1_tanggal = document.getElementById("id_riw_antimikroba_1_tanggal").value;
        const id_riw_antimikroba_1_dosis = document.getElementById("id_riw_antimikroba_1_dosis").value;
        const id_riw_antimikroba_1_per_hari = document.getElementById("riw_antimikroba_1_per_hari").value;
        const id_riw_antimikroba_1_durasi = document.getElementById("id_riw_antimikroba_1_durasi").value;
        const id_riw_antimikroba_2_nama = document.getElementById("id_riw_antimikroba_2_nama").value;
        const id_riw_antimikroba_2_tanggal = document.getElementById("id_riw_antimikroba_2_tanggal").value;
        const id_riw_antimikroba_2_dosis = document.getElementById("id_riw_antimikroba_2_dosis").value;
        const id_riw_antimikroba_2_per_hari = document.getElementById("riw_antimikroba_2_per_hari").value;
        const id_riw_antimikroba_2_durasi = document.getElementById("id_riw_antimikroba_2_durasi").value;
        const id_riw_antimikroba_3_nama = document.getElementById("id_riw_antimikroba_3_nama").value;
        const id_riw_antimikroba_3_tanggal = document.getElementById("id_riw_antimikroba_3_tanggal").value;
        const id_riw_antimikroba_3_dosis = document.getElementById("id_riw_antimikroba_3_dosis").value;
        const id_riw_antimikroba_3_per_hari = document.getElementById("riw_antimikroba_3_per_hari").value;
        const id_riw_antimikroba_3_durasi = document.getElementById("id_riw_antimikroba_3_durasi").value;
        const id_permintaan_antimikroba_1_nama = document.getElementById("id_permintaan_antimikroba_1_nama").value;
        const id_permintaan_antimikroba_dosis_1 = document.getElementById("id_permintaan_antimikroba_dosis_1").value;
        const id_permintaan_antimikroba_hari_1 = document.getElementById("id_permintaan_antimikroba_hari_1").value;
        const id_permintaan_antimikroba_1_durasi = document.getElementById("id_permintaan_antimikroba_1_durasi").value;
        const id_permintaan_antimikroba_1_indikasi = document.querySelector('input[name="permintaan_antimikroba_1_indikasi"]:checked').value;
        const id_kultur_ada = document.querySelector('input[name="kultur_ada"]:checked').value;
        const id_kultur_tanggal = document.getElementById("id_kultur_tanggal").value;
        const id_kultur_hasil_tanggal = document.getElementById("id_kultur_hasil_tanggal").value;
        const id_kultur_hasil_spesimen = document.getElementById("id_kultur_hasil_spesimen").value;
        const id_kultur_hasil_akhir = document.getElementById("id_kultur_hasil_akhir").value;
        const id_kultur_hasil_resistensi = document.getElementById("id_kultur_hasil_resistensi").value;
        const id_darah_lengkap_ada = document.querySelector('input[name="darah_lengkap_ada"]:checked').value;
        const id_darah_lengkap_tanggal = document.getElementById("id_darah_lengkap_tanggal").value;
        const id_darah_lengkap_hasil = document.getElementById("id_darah_lengkap_hasil").value;
        const id_urine_lengkap_ada = document.querySelector('input[name="urine_lengkap_ada"]:checked').value;
        const id_urine_lengkap_tanggal = document.getElementById("id_urine_lengkap_tanggal").value;
        const id_urine_lengkap_hasil = document.getElementById("id_urine_lengkap_hasil").value;
        const id_crp_ada = document.querySelector('input[name="crp_ada"]:checked').value;
        const id_crp_tanggal = document.getElementById("id_crp_tanggal").value;
        const id_crp_hasil = document.getElementById("id_crp_hasil").value;
        const id_prokalsitonin_ada = document.querySelector('input[name="prokalsitonin_ada"]:checked').value;
        const id_prokalsitonin_tanggal = document.getElementById("id_prokalsitonin_tanggal").value;
        const id_prokalsitonin_hasil = document.getElementById("id_prokalsitonin_hasil").value;
        const id_radiologi_1_pemeriksaan = document.getElementById("id_radiologi_1_pemeriksaan").value;
        const id_radiologi_1_tanggal = document.getElementById("id_radiologi_1_tanggal").value;
        const id_radiologi_1_hasil = document.getElementById("id_radiologi_1_hasil").value;
        const id_radiologi_2_pemeriksaan = document.getElementById("id_radiologi_2_pemeriksaan").value;
        const id_radiologi_2_tanggal = document.getElementById("id_radiologi_2_tanggal").value;
        const id_radiologi_2_hasil = document.getElementById("id_radiologi_2_hasil").value;







      // Add header image (replace with your image URL)
      const imgUrl = "https://i.ibb.co.com/ZVjH49t/Stempel-PPRA.png"; // Add the actual image URL
      const imgWidth = 25; // Adjust the width
      const imgHeight = 25; // Adjust the height
      doc.addImage(imgUrl, 'PNG', 25, 20, imgWidth, imgHeight);

      // Add header text
      doc.setFontSize(12);
      doc.text("YAYASAN ELISABETH GRUYTERS", 60, 25);
      doc.text("RUMAH SAKIT ST. CAROLUS BORROMEUS", 60, 30);
      doc.text("Jalan HR Koroh, KM.08. Bello Kupang", 60, 35);
      doc.text("Tlp. (0380) 8438508, E-mail: rscbkupang@gmail.com", 60, 45);

      doc.line(20, 50, 200, 50);

      // Add form title
      doc.setFontSize(14);
      doc.text("FORMULIR PERMINTAAN ANTIMIKROBA GOLONGAN RESERVE", 30, 60);

      // Add form fields with interpolated data
      doc.setFontSize(12);
      doc.text(`Nama DPJP      : ${id_nama_dpjp}`, 20, 70);
      doc.text(`Nama Pasien    : ${id_nama_pasien}`, 20, 80);
      doc.text(`Tanggal Lahir    : ${id_tanggal_lahir}`, 20, 90);
      doc.text(`Jenis Kelamin       : ${id_jenis_kelamin}`, 110, 90);
      doc.text(`Berat Badan      : ${id_berat_badan} Kg`, 20, 100);
      doc.text(`No. Rekam Medis : ${id_no_rekam_medis}`, 110, 100);
      doc.text(`Tanggal MRS    : ${id_tanggal_mrs}`, 20, 110);
      doc.text(`Ruangan              : ${id_ruangan}`, 110, 110);
      doc.text(`Diagnosis           : ${id_diagnosis}`, 20, 120);
      doc.text(`Kode ICD-10         : ${id_kode_ICD}`, 110, 120);
      doc.text(`Penyakit Penyerta  : ${id_penyakit_penyerta}`, 20, 130);
      doc.text(`Anamnesis Singkat : ${id_kondisi_saat_ini}`, 20, 150);
      doc.text(`Keadaan Umum : ${id_keadaan_umum}`, 20, 180);

      // Add table for vital signs
      doc.autoTable({
        startY: 185,
        head: [['Tanda Vital', 'Saat Masuk', 'Sekarang']],
        body: [
        ['GCS', id_GCS_masuk, id_GCS_sekarang],  
        ['Tekanan Darah', id_tekanan_darah_masuk + ' mmHg', id_tekanan_darah_sekarang + ' mmHg'],
        ['Nadi', id_nadi_masuk + ' x/menit', id_nadi_sekarang + ' x/menit'],
        ['RR', id_rr_masuk + ' x/menit', id_rr_sekarang + ' x/menit'],
        ['Suhu', id_suhu_masuk + ' °C', id_suhu_sekarang + ' °C']
        ],
        theme: 'grid',
        styles: { fontSize: 12 }
      });

      // Add additional text fields
      const tableEndPos = doc.lastAutoTable.finalY;
      doc.text(`Pemeriksaan Fisik : ${id_pemeriksaan_fisik}`, 20, tableEndPos + 10);

      doc.addPage()
      y = 0

      doc.text(`Pasien rujukan : ${id_pasien_rujukan}`, 20, 30);
      doc.text(`Nama RS Rujukan : ${id_nama_rs_rujukan}`, 110, 30);

      doc.text("Riwayat Antimikroba Sebelumnya:", 20, 40)
      doc.autoTable({
        startY:45,
        head: [['Antimikroba Sebelumnya', 'Tanggal Pertama Pemberian', 'Dosis Per Pemberian', 'Pemberian Per Hari', 'Durasi Pemberian']],
        body: [
        [id_riw_antimikroba_1_nama, id_riw_antimikroba_1_tanggal, id_riw_antimikroba_1_dosis, id_riw_antimikroba_1_per_hari, id_riw_antimikroba_1_durasi],  
        [id_riw_antimikroba_2_nama, id_riw_antimikroba_2_tanggal, id_riw_antimikroba_2_dosis, id_riw_antimikroba_2_per_hari, id_riw_antimikroba_2_durasi],
        [id_riw_antimikroba_3_nama, id_riw_antimikroba_3_tanggal, id_riw_antimikroba_3_dosis, id_riw_antimikroba_3_per_hari, id_riw_antimikroba_3_durasi],
        ],
        theme: 'grid',
        styles: { fontSize: 12 }
      });

      const tableEndPos2 = doc.lastAutoTable.finalY;
      doc.text("Permintaan Antimikroba:", 20, tableEndPos2 + 10);
      doc.text(`Nama Antimikroba          : ${id_permintaan_antimikroba_1_nama}`, 20, tableEndPos2 + 20);
      doc.text(`Dosis Per Pemberian       : ${id_permintaan_antimikroba_dosis_1}`, 20, tableEndPos2 + 30);
      doc.text(`Pemberian Per Hari        : ${id_permintaan_antimikroba_hari_1}`, 20, tableEndPos2 + 40);
      doc.text(`Perkiraan Durasi Pemberian: ${id_permintaan_antimikroba_1_durasi}`, 20, tableEndPos2 + 50);
      doc.text(`Indikasi                  : ${id_permintaan_antimikroba_1_indikasi}`, 20, tableEndPos2 + 60);

      doc.line(20, tableEndPos2 + 70, 200, tableEndPos2 + 70);

      doc.text("Hasil Penunjang:", 20, tableEndPos2 + 80)
      doc.text(`Hasil Kultur: ${id_kultur_ada}`, 20, tableEndPos2 +  90)
      doc.text(`Tanggal Pengambilan Kultur: ${id_kultur_ada}`, 100, tableEndPos2 + 90)

      doc.text("Hasil Pengambilan Kultur:", 100, tableEndPos2 + 100)

      doc.autoTable({
        startY: tableEndPos2 + 110,
        head: [['Tanggal Kultur', 'Spesimen', 'Hasil', 'Resistensi']],
        body: [
        [id_kultur_hasil_tanggal, id_kultur_hasil_spesimen, id_kultur_hasil_akhir, id_kultur_hasil_resistensi],  
        ],
        theme: 'grid',
        styles: { fontSize: 12 }
      });

      doc.addPage()
      y = 0

      doc.text("Hasil Laboratorium", 20, 30)

      doc.autoTable({
        startY:35,
        head: [['Pemeriksaan', 'Ada?', 'Tanggal', 'Hasil']],
        body: [
        ["Darah Lengkap", id_darah_lengkap_ada, id_darah_lengkap_tanggal, id_darah_lengkap_hasil],  
        ["Urine Lengkap", id_urine_lengkap_ada, id_urine_lengkap_tanggal, id_urine_lengkap_hasil],  
        ["CRP", id_crp_ada, id_crp_tanggal, id_crp_hasil],  
        ["Prokalsitonin", id_prokalsitonin_ada, id_prokalsitonin_tanggal, id_prokalsitonin_hasil],  
        ],
        theme: 'grid',
        styles: { fontSize: 12 }
      });

      const tableEndPos3 = doc.lastAutoTable.finalY;
      doc.line(20, tableEndPos3 + 15, 200, tableEndPos2 + 15);



      doc.text("Hasil Pemeriksaan Radiologi:", 25, tableEndPos3 + 25)
      doc.autoTable({
        startY: tableEndPos3 + 30,
        head: [['Pemeriksaan', 'Tanggal', 'Hasil']],
        body: [
        [id_radiologi_1_pemeriksaan, id_radiologi_1_tanggal, id_radiologi_1_hasil],  
        [id_radiologi_2_pemeriksaan, id_radiologi_2_tanggal, id_radiologi_2_hasil],
        ],
        theme: 'grid',
        styles: { fontSize: 12 }
      });

      // Save the PDF
      
    const fileName = `${id_no_rekam_medis} ${id_nama_pasien} - Formulir Permintaan Antimikroba Reserve.pdf`;
    doc.save(fileName);
    }

      });
    </script>
<footer class="footer m-0 p-2 pl-4 has-text-centered">
    <p>
        rimba
    </p>
</footer>
  
</html>
